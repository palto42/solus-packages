From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Chris Liddell <chris.liddell@artifex.com>
Date: Mon, 17 Jul 2023 14:06:37 +0100
Subject: [PATCH 04/11] Bug 706897: Copy pcx buffer overrun fix from
 devices/gdevpcx.c

Bounds check the buffer, before dereferencing the pointer.
---
 base/gdevdevn.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/base/gdevdevn.c b/base/gdevdevn.c
index b11594ce6..0d20a139f 100644
--- a/base/gdevdevn.c
+++ b/base/gdevdevn.c
@@ -1950,7 +1950,7 @@ devn_pcx_write_rle(const byte * from, const byte * end, int step, gp_file * file
         byte data = *from;
 
         from += step;
-        if (data != *from || from == end) {
+        if (from >= end || data != *from) {
             if (data >= 0xc0)
                 gp_fputc(0xc1, file);
         } else {
